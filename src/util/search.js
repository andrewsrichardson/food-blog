export default function search(query) {
  let index = []
  let store = []
  if (typeof window !== "undefined") {
    index = window.__FLEXSEARCH__.en.index
    store = window.__FLEXSEARCH__.en.store
    if (!query || !index) {
      return []
    } else {
      var results = []
      Object.keys(index).forEach(idx => {
        results.push(...index[idx].values.search(query))
      })

      results = Array.from(new Set(results))

      var nodes = store
        .filter(node => (results.includes(node.id) ? node : null))
        .map(node => node.node)

      return nodes
    }
  } else return []
}
